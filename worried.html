<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Understanding Worry</title>

  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #F3FAFF;
      --ink:#1F2937;
      --muted:#64748B;
      --card:#ffffff;
      --border:#E5E7EB;

      --purple1:#7C3AED;
      --purple2:#5B21B6;

      --blue1:#3B82F6;
      --blue2:#1D4ED8;

      --teal1:#14B8A6;
      --teal2:#0F766E;

      --amber1:#F59E0B;
      --amber2:#B45309;

      --rose1:#F43F5E;
      --rose2:#BE123C;

      --slateBtn1:#94A3B8;
      --slateBtn2:#475569;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family:'Fredoka', sans-serif;
      background:
        radial-gradient(#BFE8FF 1.5px, transparent 1.5px) 0 0 / 30px 30px,
        radial-gradient(#BFE8FF 1.5px, transparent 1.5px) 15px 15px / 30px 30px,
        var(--bg);
      color:var(--ink);
      min-height:100vh;
      display:flex;
      justify-content:center;
      overflow-x:hidden;
    }

    #app-container{
      width:100%;
      max-width:860px;
      padding:34px 18px 50px;
    }

    .title{
      text-align:center;
      font-size:42px;
      line-height:1.05;
      letter-spacing:0.2px;
      margin: 8px 0 6px;
      font-weight:700;
      color:var(--ink);
    }
    .subtitle{
      text-align:center;
      color:var(--muted);
      font-size:18px;
      margin:0 0 26px;
    }

    .grid-2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:22px;
    }
    @media (max-width:650px){
      .grid-2{ grid-template-columns:1fr; }
      .title{ font-size:36px; }
    }

    .white-card{
      background:var(--card);
      border-radius:26px;
      padding:22px;
      box-shadow: 0 14px 26px rgba(2, 6, 23, 0.08);
      border:1px solid rgba(148,163,184,0.25);
      position:relative;
      overflow:hidden;
      transition: transform .18s ease;
    }
    .white-card:hover{ transform: translateY(-4px); }

    .card-title{
      font-size:22px;
      font-weight:700;
      margin:10px 0 6px;
      text-align:center;
    }
    .card-desc{
      text-align:center;
      margin:0;
      color:var(--muted);
      line-height:1.45;
      font-size:16px;
    }

    .btn{
      width:100%;
      border:none;
      border-radius:16px;
      padding:14px 16px;
      font-size:18px;
      font-weight:700;
      cursor:pointer;
      margin-top:14px;
      color:#fff;
      box-shadow: 0 10px 18px rgba(2, 6, 23, 0.12);
      transition: transform .12s ease, filter .12s ease, opacity .12s ease;
    }
    .btn:hover{ transform: scale(1.01); filter: brightness(1.06); }
    .btn:disabled{ opacity:.75; cursor:not-allowed; transform:none; }

    .btn-purple{ background: linear-gradient(135deg, var(--purple1), var(--purple2)); }
    .btn-blue{ background: linear-gradient(135deg, var(--blue1), var(--blue2)); }
    .btn-teal{ background: linear-gradient(135deg, var(--teal1), var(--teal2)); }
    .btn-amber{ background: linear-gradient(135deg, var(--amber1), var(--amber2)); }
    .btn-rose{ background: linear-gradient(135deg, var(--rose1), var(--rose2)); }
    .btn-slate{ background: linear-gradient(135deg, var(--slateBtn1), var(--slateBtn2)); }

    .btn-back{
      background:#fff;
      border:2px solid rgba(148,163,184,0.5);
      color:#334155;
      border-radius:14px;
      padding:8px 14px;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 10px 16px rgba(2, 6, 23, 0.06);
      margin-bottom:16px;
    }

    .footer-link{
      text-align:center;
      margin-top:18px;
    }
    .footer-link a{
      color:#94A3B8;
      text-decoration:none;
      font-weight:700;
    }

    /* --- “Sticker” stage for SVG scenes --- */
    .scene-wrap{
      width:150px;
      height:150px;
      margin: 2px auto 8px;
      filter: drop-shadow(0 12px 14px rgba(2,6,23,.14));
    }
    .scene-wrap svg{ width:100%; height:100%; display:block; }

    /* General playful motion helpers */
    @keyframes floaty{ 0%,100%{ transform:translateY(0) } 50%{ transform:translateY(-10px) } }
    @keyframes wobble{ 0%,100%{ transform:rotate(-3deg) } 50%{ transform:rotate(3deg) } }
    @keyframes pop{ 0%{ transform:scale(1) } 40%{ transform:scale(1.10) } 70%{ transform:scale(.98) } 100%{ transform:scale(1) } }
    @keyframes shakeX{
      0%{ transform:translateX(0) }
      15%{ transform:translateX(-6px) }
      35%{ transform:translateX(7px) }
      55%{ transform:translateX(-5px) }
      75%{ transform:translateX(6px) }
      100%{ transform:translateX(0) }
    }

    .floaty{ animation: floaty 2.8s ease-in-out infinite; transform-origin:center; }
    .wobble{ animation: wobble .9s ease-in-out infinite; transform-origin:center; }
    .poppy{ animation: pop .55s ease-out 1; transform-origin:center; }

    /* Tool UI */
    .mini-box{
      background: rgba(59,130,246,0.08);
      border: 2px dashed rgba(59,130,246,0.35);
      border-radius:18px;
      padding:12px 12px;
      color:#1E40AF;
      margin-top:12px;
      text-align:center;
      font-weight:700;
    }
    .input{
      width:100%;
      border:2px solid rgba(148,163,184,0.45);
      border-radius:14px;
      padding:12px 12px;
      font-size:16px;
      font-family:'Fredoka', sans-serif;
      outline:none;
      margin-top:12px;
    }
    .input:focus{
      border-color: rgba(124,58,237,0.55);
      box-shadow: 0 0 0 4px rgba(124,58,237,0.15);
    }

    .pill{
      display:inline-block;
      padding:6px 10px;
      border-radius:999px;
      font-weight:800;
      font-size:12px;
      letter-spacing:.6px;
      text-transform:uppercase;
    }
    .pill-purple{ background: rgba(124,58,237,.12); color:#5B21B6; }
    .pill-blue{ background: rgba(59,130,246,.12); color:#1D4ED8; }
    .pill-teal{ background: rgba(20,184,166,.12); color:#0F766E; }
    .pill-amber{ background: rgba(245,158,11,.14); color:#92400E; }
    .pill-rose{ background: rgba(244,63,94,.12); color:#9F1239; }
    .pill-slate{ background: rgba(100,116,139,.12); color:#334155; }

    .tool-title{
      text-align:center;
      margin-top:6px;
      font-size:22px;
      font-weight:800;
    }
    .tool-desc{
      text-align:center;
      color:var(--muted);
      margin: 6px 0 0;
      line-height:1.45;
    }

    .row-2{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:14px;
      margin-top:12px;
    }
    @media (max-width:650px){
      .row-2{ grid-template-columns:1fr; }
    }

    .tiny-note{
      font-size:13px;
      color:#64748B;
      text-align:center;
      margin-top:10px;
    }

    /* For “Shake & Reset” */
    .card-shaking{ animation: shakeX .35s linear infinite; }

    /* Box-breath label */
    .breath-label{
      text-align:center;
      font-weight:900;
      color:#0F766E;
      font-size:22px;
      margin-top:10px;
      letter-spacing:.3px;
    }

    /* Timer */
    .timer{
      text-align:center;
      font-weight:900;
      font-size:34px;
      margin-top:10px;
      color:#334155;
    }

  </style>
</head>

<body>
  <div id="app-container"></div>

  <script>
    const container = document.getElementById("app-container");

    // --- GLOBAL CLEANUP FOR INTERVALS/TIMERS ---
    let intervals = [];
    function addInterval(id){ intervals.push(id); }
    function clearAllIntervals(){
      intervals.forEach(id => { try{ clearInterval(id); }catch(e){} });
      intervals = [];
    }

    // --- SVG SCENES (all different, no external images) ---
    const SVG = {
      homeWorrySwirl: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gCloud" cx="35%" cy="28%" r="75%">
                <stop offset="0%" stop-color="#ffffff"/>
                <stop offset="55%" stop-color="#EEF2FF"/>
                <stop offset="100%" stop-color="#D8E3FF"/>
              </radialGradient>
              <radialGradient id="gStorm" cx="50%" cy="40%" r="70%">
                <stop offset="0%" stop-color="rgba(124,58,237,0.35)"/>
                <stop offset="100%" stop-color="rgba(124,58,237,0)"/>
              </radialGradient>
            </defs>

            <g class="floaty">
              <path d="M52 122
                      C36 122, 26 112, 26 98
                      C26 84, 36 74, 50 74
                      C56 54, 75 42, 96 48
                      C112 32, 142 36, 152 56
                      C170 58, 182 72, 176 90
                      C190 98, 192 120, 173 126
                      C161 141, 136 152, 113 144
                      C98 158, 68 154, 60 138
                      C56 130, 54 126, 52 122 Z"
                    fill="url(#gCloud)" />
              <ellipse cx="104" cy="122" rx="72" ry="40" fill="rgba(15,23,42,0.05)"/>
              <circle cx="86" cy="92" r="7" fill="#111827"/>
              <circle cx="126" cy="92" r="7" fill="#111827"/>
              <path d="M92 112 C102 104, 110 104, 120 112" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
            </g>

            <g class="wobble" opacity="0.9">
              <path d="M70 42
                       C85 20, 110 20, 124 42
                       C136 62, 110 74, 96 58
                       C82 42, 105 38, 114 50"
                    fill="none" stroke="#7C3AED" stroke-width="7" stroke-linecap="round"/>
              <circle cx="140" cy="55" r="5" fill="#F59E0B"/>
              <circle cx="60" cy="60" r="4" fill="#3B82F6"/>
            </g>

            <ellipse cx="100" cy="70" rx="85" ry="70" fill="url(#gStorm)"/>
          </svg>
        </div>
      `,

      homeTools: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gShield" x1="0" x2="1">
                <stop offset="0" stop-color="#14B8A6"/>
                <stop offset="1" stop-color="#0F766E"/>
              </linearGradient>
              <linearGradient id="gStar" x1="0" x2="1">
                <stop offset="0" stop-color="#FDE68A"/>
                <stop offset="1" stop-color="#F59E0B"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <path d="M100 26
                       C120 40, 148 44, 164 52
                       V100
                       C164 142, 132 164, 100 178
                       C68 164, 36 142, 36 100
                       V52
                       C52 44, 80 40, 100 26 Z"
                    fill="url(#gShield)" opacity="0.95"/>
              <path d="M74 94 L92 112 L128 76" fill="none" stroke="#ECFEFF" stroke-width="14" stroke-linecap="round" stroke-linejoin="round"/>
            </g>

            <g class="wobble">
              <path d="M54 52 l8 14 l-14 -8 l14 -8 z" fill="url(#gStar)"/>
              <path d="M150 58 l7 12 l-12 -7 l12 -7 z" fill="url(#gStar)"/>
              <circle cx="152" cy="128" r="6" fill="#3B82F6" opacity="0.9"/>
            </g>
          </svg>
        </div>
      `,

      behaviorOverthink: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gHead" cx="35%" cy="30%" r="70%">
                <stop offset="0%" stop-color="#FFF7ED"/>
                <stop offset="100%" stop-color="#FED7AA"/>
              </radialGradient>
              <linearGradient id="gSpiral" x1="0" x2="1">
                <stop offset="0" stop-color="#7C3AED"/>
                <stop offset="1" stop-color="#3B82F6"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <circle cx="90" cy="112" r="44" fill="url(#gHead)"/>
              <circle cx="76" cy="108" r="7" fill="#111827"/>
              <circle cx="102" cy="108" r="7" fill="#111827"/>
              <path d="M74 128 C86 120, 96 120, 108 128" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
            </g>

            <g class="wobble">
              <path d="M118 42
                       C160 46, 164 88, 132 92
                       C108 95, 108 66, 132 66
                       C150 66, 152 82, 138 82
                       C124 82, 128 72, 136 72"
                    fill="none" stroke="url(#gSpiral)" stroke-width="10" stroke-linecap="round"/>
              <circle cx="150" cy="56" r="6" fill="#F59E0B"/>
              <circle cx="160" cy="78" r="5" fill="#F43F5E"/>
            </g>
          </svg>
        </div>
      `,

      behaviorAvoid: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gDoor" x1="0" x2="1">
                <stop offset="0" stop-color="#94A3B8"/>
                <stop offset="1" stop-color="#475569"/>
              </linearGradient>
              <radialGradient id="gPeek" cx="30%" cy="30%" r="70%">
                <stop offset="0" stop-color="#ffffff"/>
                <stop offset="1" stop-color="#DBEAFE"/>
              </radialGradient>
            </defs>

            <rect x="42" y="34" width="116" height="150" rx="18" fill="url(#gDoor)" opacity="0.95"/>
            <rect x="54" y="48" width="54" height="120" rx="14" fill="rgba(255,255,255,0.15)"/>

            <g class="floaty">
              <circle cx="118" cy="118" r="30" fill="url(#gPeek)"/>
              <circle cx="108" cy="114" r="6" fill="#111827"/>
              <circle cx="130" cy="114" r="6" fill="#111827"/>
              <path d="M110 132 C118 126, 126 126, 134 132" fill="none" stroke="#111827" stroke-width="6" stroke-linecap="round"/>
            </g>

            <g class="wobble">
              <path d="M168 80 l7 12 l-12 -7 l12 -7 z" fill="#F59E0B" opacity="0.95"/>
            </g>
          </svg>
        </div>
      `,

      behaviorWhatIf: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gBubble" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#ffffff"/>
                <stop offset="100%" stop-color="#E0F2FE"/>
              </radialGradient>
              <linearGradient id="gQ" x1="0" x2="1">
                <stop offset="0" stop-color="#7C3AED"/>
                <stop offset="1" stop-color="#5B21B6"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <ellipse cx="100" cy="92" rx="76" ry="56" fill="url(#gBubble)"/>
              <circle cx="62" cy="132" r="10" fill="url(#gBubble)"/>
              <circle cx="50" cy="148" r="7" fill="url(#gBubble)"/>
            </g>

            <g class="wobble">
              <path d="M92 70
                       C92 52, 128 52, 128 72
                       C128 84, 116 86, 110 94
                       C106 100, 106 106, 106 110"
                    fill="none" stroke="url(#gQ)" stroke-width="12" stroke-linecap="round"/>
              <circle cx="106" cy="126" r="7" fill="url(#gQ)"/>
              <path d="M56 78 l7 12 l-12 -7 l12 -7 z" fill="#F59E0B"/>
              <path d="M150 90 l6 10 l-10 -6 l10 -6 z" fill="#3B82F6"/>
            </g>
          </svg>
        </div>
      `,

      behaviorButterflies: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gTummy" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#FFE4E6"/>
                <stop offset="100%" stop-color="#FDA4AF"/>
              </radialGradient>
              <linearGradient id="gWing" x1="0" x2="1">
                <stop offset="0" stop-color="#60A5FA"/>
                <stop offset="1" stop-color="#7C3AED"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <path d="M74 60
                       C54 72, 48 92, 56 112
                       C66 138, 92 156, 108 156
                       C126 156, 150 138, 158 112
                       C166 92, 160 72, 140 60
                       C122 50, 94 50, 74 60 Z"
                    fill="url(#gTummy)"/>
              <circle cx="86" cy="92" r="6" fill="#111827"/>
              <circle cx="114" cy="92" r="6" fill="#111827"/>
              <path d="M90 112 C100 120, 108 120, 118 112" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
            </g>

            <g class="wobble" transform="translate(0,0)">
              <path d="M96 92
                       C84 80, 70 80, 66 94
                       C62 108, 78 112, 88 102
                       C88 120, 70 126, 64 114
                       C56 96, 78 74, 96 92 Z"
                    fill="url(#gWing)" opacity="0.95"/>
              <path d="M104 92
                       C116 80, 130 80, 134 94
                       C138 108, 122 112, 112 102
                       C112 120, 130 126, 136 114
                       C144 96, 122 74, 104 92 Z"
                    fill="url(#gWing)" opacity="0.95"/>
              <rect x="98" y="90" width="4" height="30" rx="2" fill="#111827"/>
              <circle cx="100" cy="88" r="6" fill="#111827"/>
            </g>
          </svg>
        </div>
      `,

      consequenceFog: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gBrain" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#E0F2FE"/>
                <stop offset="100%" stop-color="#93C5FD"/>
              </radialGradient>
            </defs>
            <g class="floaty">
              <path d="M70 70
                       C55 70, 46 82, 48 96
                       C32 102, 34 126, 52 130
                       C56 150, 80 158, 94 146
                       C104 160, 132 158, 140 140
                       C162 138, 170 112, 154 100
                       C160 82, 146 64, 128 70
                       C118 56, 92 54, 84 70
                       C80 64, 74 62, 70 70 Z"
                    fill="url(#gBrain)"/>
              <path d="M74 96 C86 86, 100 86, 112 96" fill="none" stroke="#1F2937" stroke-width="7" stroke-linecap="round" opacity="0.8"/>
              <circle cx="82" cy="104" r="6" fill="#1F2937"/>
              <circle cx="118" cy="104" r="6" fill="#1F2937"/>
              <path d="M76 126 C92 118, 108 118, 124 126" fill="none" stroke="#1F2937" stroke-width="7" stroke-linecap="round" opacity="0.65"/>
            </g>

            <g class="wobble" opacity="0.8">
              <ellipse cx="60" cy="62" rx="20" ry="10" fill="rgba(255,255,255,0.7)"/>
              <ellipse cx="140" cy="58" rx="22" ry="11" fill="rgba(255,255,255,0.65)"/>
              <ellipse cx="150" cy="92" rx="18" ry="9" fill="rgba(255,255,255,0.6)"/>
            </g>
          </svg>
        </div>
      `,

      consequenceTight: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gBand" x1="0" x2="1">
                <stop offset="0" stop-color="#F43F5E"/>
                <stop offset="1" stop-color="#BE123C"/>
              </linearGradient>
              <radialGradient id="gBody" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#FFF7ED"/>
                <stop offset="100%" stop-color="#FED7AA"/>
              </radialGradient>
            </defs>

            <g class="floaty">
              <circle cx="100" cy="92" r="46" fill="url(#gBody)"/>
              <path d="M76 84 C86 76, 96 76, 106 84" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
              <path d="M94 106 C102 100, 110 100, 118 106" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
              <rect x="54" y="118" width="92" height="22" rx="11" fill="url(#gBand)" opacity="0.9"/>
              <path d="M66 130 L134 130" stroke="rgba(255,255,255,0.55)" stroke-width="6" stroke-linecap="round"/>
            </g>

            <g class="wobble">
              <path d="M44 112 l7 12 l-12 -7 l12 -7 z" fill="#F59E0B"/>
              <path d="M162 108 l7 12 l-12 -7 l12 -7 z" fill="#3B82F6"/>
            </g>
          </svg>
        </div>
      `,

      consequenceSleep: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gMoon" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#E0E7FF"/>
                <stop offset="100%" stop-color="#A5B4FC"/>
              </radialGradient>
              <linearGradient id="gZ" x1="0" x2="1">
                <stop offset="0" stop-color="#7C3AED"/>
                <stop offset="1" stop-color="#3B82F6"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <circle cx="92" cy="96" r="52" fill="url(#gMoon)"/>
              <circle cx="112" cy="78" r="46" fill="rgba(243,250,255,1)"/>
              <path d="M64 120 C80 110, 96 110, 112 120" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round" opacity="0.7"/>
              <circle cx="74" cy="104" r="6" fill="#111827"/>
              <circle cx="98" cy="104" r="6" fill="#111827"/>
            </g>

            <g class="wobble">
              <path d="M132 62 L166 62 L140 94 L168 94" fill="none" stroke="url(#gZ)" stroke-width="10" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M126 116 L154 116 L132 140 L156 140" fill="none" stroke="url(#gZ)" stroke-width="9" stroke-linecap="round" stroke-linejoin="round" opacity="0.9"/>
            </g>
          </svg>
        </div>
      `,

      consequenceStomach: () => `
        <div class="scene-wrap">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gStom" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#DCFCE7"/>
                <stop offset="100%" stop-color="#86EFAC"/>
              </radialGradient>
              <linearGradient id="gWave" x1="0" x2="1">
                <stop offset="0" stop-color="#F59E0B"/>
                <stop offset="1" stop-color="#F43F5E"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <path d="M120 44
                       C108 44, 104 54, 104 64
                       C104 72, 112 78, 122 84
                       C134 92, 138 104, 132 118
                       C124 138, 104 154, 84 150
                       C64 146, 52 126, 54 106
                       C56 86, 70 74, 88 66
                       C100 60, 106 44, 120 44 Z"
                    fill="url(#gStom)"/>
              <circle cx="86" cy="108" r="6" fill="#111827"/>
              <circle cx="108" cy="108" r="6" fill="#111827"/>
              <path d="M84 126 C96 118, 98 118, 110 126" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>
            </g>

            <g class="wobble" opacity="0.9">
              <path d="M60 52 C74 62, 90 58, 104 66 C120 74, 134 70, 148 78"
                    fill="none" stroke="url(#gWave)" stroke-width="10" stroke-linecap="round"/>
            </g>
          </svg>
        </div>
      `,

      toolNameWorry: () => `
        <div class="scene-wrap" id="scene-nameworry">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gCloud2" cx="35%" cy="28%" r="75%">
                <stop offset="0%" stop-color="#ffffff"/>
                <stop offset="55%" stop-color="#EEF2FF"/>
                <stop offset="100%" stop-color="#D8E3FF"/>
              </radialGradient>
              <radialGradient id="gGlow" cx="50%" cy="50%" r="70%">
                <stop offset="0%" stop-color="rgba(245,158,11,0.35)"/>
                <stop offset="100%" stop-color="rgba(245,158,11,0)"/>
              </radialGradient>
            </defs>

            <g id="nw-cloud" class="floaty">
              <path d="M52 122
                      C36 122, 26 112, 26 98
                      C26 84, 36 74, 50 74
                      C56 54, 75 42, 96 48
                      C112 32, 142 36, 152 56
                      C170 58, 182 72, 176 90
                      C190 98, 192 120, 173 126
                      C161 141, 136 152, 113 144
                      C98 158, 68 154, 60 138
                      C56 130, 54 126, 52 122 Z"
                    fill="url(#gCloud2)" />
              <circle cx="86" cy="94" r="7" fill="#111827"/>
              <circle cx="126" cy="94" r="7" fill="#111827"/>
              <path d="M92 114 C102 106, 110 106, 120 114" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round"/>

              <!-- scribbles (shrink on success) -->
              <g id="nw-scribbles" class="wobble" opacity="0.9">
                <path d="M68 44 C84 22, 110 22, 124 44
                         C136 62, 110 74, 96 58
                         C82 42, 105 38, 114 50"
                      fill="none" stroke="#7C3AED" stroke-width="7" stroke-linecap="round"/>
                <circle cx="144" cy="58" r="5" fill="#F59E0B"/>
                <circle cx="58" cy="64" r="4" fill="#3B82F6"/>
              </g>
            </g>

            <!-- hidden sparkle glow that we show on success -->
            <g id="nw-spark" opacity="0">
              <circle cx="100" cy="90" r="80" fill="url(#gGlow)"/>
              <path d="M156 52 l7 12 l-12 -7 l12 -7 z" fill="#F59E0B" opacity="0.95"/>
              <path d="M52 58 l7 12 l-12 -7 l12 -7 z" fill="#3B82F6" opacity="0.95"/>
            </g>
          </svg>
        </div>
      `,

      toolGrounding: () => `
        <div class="scene-wrap" id="scene-ground">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gHand" x1="0" x2="1">
                <stop offset="0" stop-color="#DBEAFE"/>
                <stop offset="1" stop-color="#93C5FD"/>
              </linearGradient>
              <linearGradient id="gStar2" x1="0" x2="1">
                <stop offset="0" stop-color="#FDE68A"/>
                <stop offset="1" stop-color="#F59E0B"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <path d="M70 80
                       C70 62, 92 58, 92 78
                       V104
                       C92 86, 114 84, 114 104
                       V112
                       C114 94, 134 92, 134 112
                       V126
                       C134 108, 152 110, 150 128
                       C148 154, 126 172, 100 172
                       C76 172, 60 154, 60 132
                       V100
                       C60 84, 70 84, 70 98 Z"
                    fill="url(#gHand)" stroke="rgba(30,58,138,0.15)" stroke-width="2" />
            </g>

            <g class="wobble">
              <path d="M40 62 l7 12 l-12 -7 l12 -7 z" fill="url(#gStar2)"/>
              <path d="M160 64 l7 12 l-12 -7 l12 -7 z" fill="url(#gStar2)"/>
              <circle cx="156" cy="132" r="6" fill="#14B8A6" opacity="0.9"/>
            </g>

            <g opacity="0.9">
              <circle cx="58" cy="38" r="7" fill="#7C3AED"/>
              <circle cx="86" cy="30" r="5" fill="#F43F5E"/>
              <circle cx="118" cy="34" r="6" fill="#3B82F6"/>
            </g>
          </svg>
        </div>
      `,

      toolBoxBreath: () => `
        <div class="scene-wrap" id="scene-breath">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gFrame" x1="0" x2="1">
                <stop offset="0" stop-color="#14B8A6"/>
                <stop offset="1" stop-color="#0F766E"/>
              </linearGradient>
              <radialGradient id="gDot" cx="35%" cy="30%" r="70%">
                <stop offset="0" stop-color="#ffffff"/>
                <stop offset="100%" stop-color="#93C5FD"/>
              </radialGradient>
            </defs>

            <g class="floaty">
              <rect x="48" y="48" width="104" height="104" rx="22" fill="none" stroke="url(#gFrame)" stroke-width="12" opacity="0.95"/>
              <circle id="breath-dot" cx="48" cy="48" r="12" fill="url(#gDot)" stroke="rgba(15,23,42,0.12)" stroke-width="2"/>
              <path d="M66 34 l7 12 l-12 -7 l12 -7 z" fill="#F59E0B" opacity="0.9"/>
              <path d="M162 62 l7 12 l-12 -7 l12 -7 z" fill="#7C3AED" opacity="0.9"/>
            </g>
          </svg>
        </div>
      `,

      toolWorryBox: () => `
        <div class="scene-wrap" id="scene-wbox">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gBox" x1="0" x2="1">
                <stop offset="0" stop-color="#FDE68A"/>
                <stop offset="1" stop-color="#F59E0B"/>
              </linearGradient>
              <radialGradient id="gBlob" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#ffffff"/>
                <stop offset="100%" stop-color="#E0E7FF"/>
              </radialGradient>
            </defs>

            <g class="floaty">
              <rect x="52" y="84" width="96" height="78" rx="18" fill="url(#gBox)" opacity="0.95"/>
              <rect x="52" y="70" width="96" height="26" rx="14" fill="rgba(245,158,11,0.65)"/>
              <circle cx="100" cy="84" r="6" fill="rgba(15,23,42,0.25)"/>
            </g>

            <g id="wbox-blob" class="wobble">
              <path d="M80 46
                       C60 50, 56 72, 74 84
                       C60 98, 72 122, 96 114
                       C110 130, 142 118, 130 94
                       C148 84, 144 56, 120 54
                       C112 40, 92 38, 80 46 Z"
                    fill="url(#gBlob)"/>
              <circle cx="88" cy="78" r="6" fill="#111827"/>
              <circle cx="112" cy="78" r="6" fill="#111827"/>
              <path d="M90 96 C100 88, 104 88, 114 96" fill="none" stroke="#111827" stroke-width="7" stroke-linecap="round" opacity="0.8"/>
            </g>

            <g id="wbox-spark" opacity="0">
              <path d="M158 54 l7 12 l-12 -7 l12 -7 z" fill="#7C3AED" opacity="0.95"/>
              <circle cx="52" cy="56" r="6" fill="#3B82F6" opacity="0.95"/>
              <circle cx="164" cy="118" r="5" fill="#F43F5E" opacity="0.95"/>
            </g>
          </svg>
        </div>
      `,

      toolFacts: () => `
        <div class="scene-wrap" id="scene-facts">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <linearGradient id="gGlass" x1="0" x2="1">
                <stop offset="0" stop-color="#7C3AED"/>
                <stop offset="1" stop-color="#3B82F6"/>
              </linearGradient>
              <radialGradient id="gLens" cx="40%" cy="35%" r="75%">
                <stop offset="0" stop-color="#ffffff" stop-opacity="0.95"/>
                <stop offset="100%" stop-color="#DBEAFE" stop-opacity="0.65"/>
              </radialGradient>
            </defs>

            <g class="floaty">
              <circle cx="94" cy="92" r="50" fill="url(#gLens)" stroke="rgba(30,64,175,0.20)" stroke-width="6"/>
              <rect x="120" y="122" width="58" height="16" rx="8" transform="rotate(35 120 122)" fill="url(#gGlass)"/>
              <circle cx="78" cy="92" r="4" fill="#111827" opacity="0.55"/>
              <circle cx="108" cy="92" r="4" fill="#111827" opacity="0.55"/>
              <path d="M70 110 L112 110" stroke="#111827" stroke-width="7" stroke-linecap="round" opacity="0.35"/>
            </g>

            <g class="wobble">
              <path d="M64 58 C74 50, 84 50, 94 58" fill="none" stroke="#F43F5E" stroke-width="8" stroke-linecap="round" opacity="0.8"/>
              <path d="M88 76 L104 92 L134 62" fill="none" stroke="#14B8A6" stroke-width="10" stroke-linecap="round" stroke-linejoin="round" opacity="0.85"/>
            </g>
          </svg>
        </div>
      `,

      toolShake: () => `
        <div class="scene-wrap" id="scene-shake">
          <svg viewBox="0 0 200 200" aria-hidden="true">
            <defs>
              <radialGradient id="gSpring" cx="35%" cy="30%" r="75%">
                <stop offset="0" stop-color="#ffffff"/>
                <stop offset="100%" stop-color="#FECACA"/>
              </radialGradient>
              <linearGradient id="gBolt" x1="0" x2="1">
                <stop offset="0" stop-color="#FDE68A"/>
                <stop offset="1" stop-color="#F59E0B"/>
              </linearGradient>
            </defs>

            <g class="floaty">
              <rect x="62" y="46" width="76" height="76" rx="20" fill="url(#gSpring)" stroke="rgba(190,18,60,0.18)" stroke-width="3"/>
              <path d="M100 58 L92 80 L106 80 L96 112 L114 86 L100 86 Z" fill="url(#gBolt)" opacity="0.95"/>
            </g>

            <g class="wobble" opacity="0.9">
              <circle cx="46" cy="88" r="6" fill="#7C3AED"/>
              <circle cx="154" cy="76" r="6" fill="#3B82F6"/>
              <path d="M152 128 l7 12 l-12 -7 l12 -7 z" fill="#14B8A6"/>
              <path d="M54 132 l7 12 l-12 -7 l12 -7 z" fill="#F43F5E"/>
            </g>
          </svg>
        </div>
      `
    };

    // --- VIEWS ---
    function showHome(){
      clearAllIntervals();
      container.innerHTML = `
        <h1 class="title">Understanding Worry</h1>
        <p class="subtitle">Worry is your brain trying to protect you — but it can get too loud.</p>

        <div class="grid-2">
          <div class="white-card">
            ${SVG.homeWorrySwirl()}
            <div class="card-title">The Worry Swirl</div>
            <p class="card-desc">“What if something bad happens?”</p>
            <button class="btn btn-purple" onclick="showReactions()">See What Worry Does</button>
          </div>

          <div class="white-card">
            ${SVG.homeTools()}
            <div class="card-title">Comfort Tools</div>
            <p class="card-desc">Smart ways to calm the worry alarm.</p>
            <button class="btn btn-teal" onclick="showSolutions()">Show Comfort Tools</button>
          </div>
        </div>

        <div class="footer-link">
          <a href="index.html">← Back to Menu</a>
        </div>
      `;
    }

    function showReactions(){
      clearAllIntervals();
      container.innerHTML = `
        <button class="btn-back" onclick="showHome()">← Back</button>
        <h1 class="title" style="color:var(--purple2)">How Worry Shows Up</h1>
        <p class="subtitle" style="margin-bottom:18px">These are common “worry moves.” They feel real — but they can trap you.</p>

        <div class="grid-2">
          <div class="white-card">
            ${SVG.behaviorOverthink()}
            <div class="card-title">Overthinking</div>
            <p class="card-desc">Your brain spins the same thought again and again.</p>
          </div>

          <div class="white-card">
            ${SVG.behaviorAvoid()}
            <div class="card-title">Avoiding</div>
            <p class="card-desc">You hide from the thing that feels scary or unknown.</p>
          </div>

          <div class="white-card">
            ${SVG.behaviorWhatIf()}
            <div class="card-title">“What if…?”</div>
            <p class="card-desc">Worry asks endless questions without answers.</p>
          </div>

          <div class="white-card">
            ${SVG.behaviorButterflies()}
            <div class="card-title">Butterflies Tummy</div>
            <p class="card-desc">Your body feels jumpy or twisty inside.</p>
          </div>
        </div>

        <div class="white-card" style="margin-top:18px; border-bottom:6px solid rgba(124,58,237,0.35)">
          <div class="card-title" style="margin-top:0">Does this help?</div>
          <p class="card-desc">Let’s see what happens if worry stays in charge.</p>
          <button class="btn btn-purple" style="width:auto; display:block; margin:14px auto 0" onclick="showConsequences()">See The Result ➜</button>
        </div>
      `;
    }

    function showConsequences(){
      clearAllIntervals();
      container.innerHTML = `
        <button class="btn-back" onclick="showReactions()">← Back</button>
        <h1 class="title" style="color:var(--purple2)">When Worry Takes Over</h1>
        <p class="subtitle" style="margin-bottom:18px">Worry can make your brain tired and your body tense.</p>

        <div class="grid-2">
          <div class="white-card">
            ${SVG.consequenceFog()}
            <div class="card-title">Brain Fog</div>
            <p class="card-desc">It’s harder to focus or decide.</p>
          </div>

          <div class="white-card">
            ${SVG.consequenceTight()}
            <div class="card-title">Tight Body</div>
            <p class="card-desc">Shoulders, jaw, or belly can feel tight.</p>
          </div>

          <div class="white-card">
            ${SVG.consequenceStomach()}
            <div class="card-title">Stomach Flips</div>
            <p class="card-desc">Your tummy feels “off” or fluttery.</p>
          </div>

          <div class="white-card">
            ${SVG.consequenceSleep()}
            <div class="card-title">Sleep Trouble</div>
            <p class="card-desc">Your mind keeps talking at bedtime.</p>
          </div>
        </div>

        <div class="white-card" style="margin-top:18px; border-bottom:6px solid rgba(20,184,166,0.35)">
          <div class="card-title" style="margin-top:0">Good news</div>
          <p class="card-desc">You can turn the worry alarm down with skills that work.</p>
          <button class="btn btn-teal" style="width:auto; display:block; margin:14px auto 0" onclick="showSolutions()">Learn Comfort Tools ➜</button>
        </div>
      `;
    }

    function showSolutions(){
      clearAllIntervals();
      container.innerHTML = `
        <button class="btn-back" onclick="showHome()">← Back to Start</button>
        <h1 class="title" style="color:var(--teal2)">Comfort Tools</h1>
        <p class="subtitle">Pick one tool. Small steps calm big worries.</p>

        <!-- TOOL 1: NAME THE WORRY -->
        <div class="white-card" style="border-bottom:6px solid rgba(124,58,237,0.35)">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-purple">Tool 1</span>
          </div>
          ${SVG.toolNameWorry()}
          <div class="tool-title" style="color:var(--purple1)">Name the Worry</div>
          <p class="tool-desc">When you put worry into words, your brain often calms down.</p>

          <input id="worry-input" class="input" maxlength="40" placeholder="Type your worry (short phrase)..." />
          <button class="btn btn-purple" onclick="doNameWorry()">Name It</button>

          <div id="worry-label" class="mini-box" style="display:none; background:rgba(124,58,237,0.10); border-color:rgba(124,58,237,0.30); color:#4C1D95;">
            You named it. Now you can handle it.
          </div>
        </div>

        <!-- TOOL 2: 5-4-3-2-1 -->
        <div class="white-card" style="border-bottom:6px solid rgba(59,130,246,0.35); margin-top:18px;">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-blue">Tool 2</span>
          </div>
          ${SVG.toolGrounding()}
          <div class="tool-title" style="color:var(--blue1)">5-4-3-2-1 Grounding</div>
          <p class="tool-desc">Bring your brain back to “right now” using your senses.</p>

          <div id="ground-step" class="mini-box" style="background:rgba(59,130,246,0.08); border-color:rgba(59,130,246,0.30); color:#1D4ED8;">
            Press Start to begin.
          </div>
          <button class="btn btn-blue" onclick="startGrounding()">Start Grounding</button>
          <div class="tiny-note">Look around. Touch something. Listen carefully. Smell the air. Taste a sip of water.</div>
        </div>

        <!-- TOOL 3: BOX BREATH -->
        <div class="white-card" style="border-bottom:6px solid rgba(20,184,166,0.35); margin-top:18px;">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-teal">Tool 3</span>
          </div>
          ${SVG.toolBoxBreath()}
          <div class="tool-title" style="color:var(--teal1)">Box Breathing</div>
          <p class="tool-desc">Slow breathing tells your nervous system: “We are safe.”</p>

          <div class="breath-label" id="breath-label">Ready</div>
          <button class="btn btn-teal" id="breath-btn" onclick="toggleBoxBreath()">Start Box Breath</button>
          <div class="tiny-note">Follow the dot around the square: In → Hold → Out → Hold.</div>
        </div>

        <!-- TOOL 4: WORRY BOX TIMER -->
        <div class="white-card" style="border-bottom:6px solid rgba(245,158,11,0.40); margin-top:18px;">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-amber">Tool 4</span>
          </div>
          ${SVG.toolWorryBox()}
          <div class="tool-title" style="color:var(--amber2)">Worry Box Timer</div>
          <p class="tool-desc">Put the worry in a box for a short time — then close the lid.</p>

          <div class="timer" id="wbox-timer">01:00</div>
          <button class="btn btn-amber" id="wbox-btn" onclick="startWorryBox()">Start 60s Worry Box</button>
          <div class="tiny-note">This is a “worry limit.” You control the timer — worry does not.</div>
        </div>

        <!-- TOOL 5: CHECK THE FACTS -->
        <div class="white-card" style="border-bottom:6px solid rgba(124,58,237,0.30); margin-top:18px;">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-purple">Tool 5</span>
          </div>
          ${SVG.toolFacts()}
          <div class="tool-title" style="color:var(--purple1)">Check the Facts</div>
          <p class="tool-desc">Worry often mixes facts with guesses. Separate them.</p>

          <div class="row-2">
            <div>
              <div class="pill pill-slate">What I know</div>
              <input id="fact-know" class="input" placeholder="One true fact..." />
            </div>
            <div>
              <div class="pill pill-rose">What I’m guessing</div>
              <input id="fact-guess" class="input" placeholder="One worry guess..." />
            </div>
          </div>

          <div style="margin-top:12px">
            <div class="pill pill-teal">One small step</div>
            <input id="fact-step" class="input" placeholder="One small helpful action..." />
          </div>

          <button class="btn btn-purple" onclick="doFacts()">Lock a Plan</button>

          <div id="facts-out" class="mini-box" style="display:none; background:rgba(20,184,166,0.10); border-color:rgba(20,184,166,0.30); color:#0F766E;">
            Plan locked.
          </div>
        </div>

        <!-- TOOL 6: SHAKE & RESET -->
        <div class="white-card" id="shake-card" style="border-bottom:6px solid rgba(244,63,94,0.30); margin-top:18px;">
          <div style="text-align:center; margin-bottom:8px">
            <span class="pill pill-rose">Tool 6</span>
          </div>
          ${SVG.toolShake()}
          <div class="tool-title" style="color:var(--rose2)">Shake & Reset</div>
          <p class="tool-desc">Move your body to help the worry energy drain away.</p>

          <div class="timer" id="shake-timer">00:10</div>
          <button class="btn btn-rose" id="shake-btn" onclick="startShake()">Start 10s Shake</button>
          <div class="tiny-note">Wiggle arms. Shake hands. Stomp softly. Then stop and notice your body.</div>
        </div>

        <div class="footer-link">
          <a href="index.html">← Back to Menu</a>
        </div>
      `;
    }

    // --- TOOL LOGIC ---
    function doNameWorry(){
      const input = document.getElementById("worry-input");
      const label = document.getElementById("worry-label");
      const cloud = document.getElementById("nw-cloud");
      const scrib = document.getElementById("nw-scribbles");
      const spark = document.getElementById("nw-spark");

      if(!input || !label) return;

      const txt = (input.value || "").trim();
      const shown = txt ? txt : "WORRY";

      label.style.display = "block";
      label.textContent = `You named it: "${shown.toUpperCase().slice(0, 32)}". Now: one small step.`;

      // animate scene: scribbles shrink + sparkle appears
      try{
        if(cloud) cloud.classList.add("poppy");
        if(scrib){
          scrib.style.transition = "transform 0.4s ease, opacity 0.4s ease";
          scrib.style.transform = "scale(0.65)";
          scrib.style.opacity = "0.45";
        }
        if(spark){
          spark.style.transition = "opacity 0.35s ease";
          spark.style.opacity = "1";
          setTimeout(()=> spark.style.opacity = "0", 900);
        }
        setTimeout(()=> { if(cloud) cloud.classList.remove("poppy"); }, 650);
      }catch(e){}
    }

    // Grounding 5-4-3-2-1
    let groundStep = 0;
    const groundScript = [
      "5 things you can SEE. (Look around.)",
      "4 things you can TOUCH. (Feel shirt, chair, hair.)",
      "3 things you can HEAR. (Listen carefully.)",
      "2 things you can SMELL. (Even a little.)",
      "1 thing you can TASTE. (Sip water, taste your mouth.)",
      "Done. You are back in the present."
    ];
    function startGrounding(){
      groundStep = 0;
      const box = document.getElementById("ground-step");
      if(!box) return;
      box.textContent = groundScript[groundStep];

      // auto-advance every 8 seconds, but user can press Start again to restart
      clearAllIntervals();
      const id = setInterval(()=>{
        groundStep++;
        if(groundStep >= groundScript.length){
          clearInterval(id);
          box.textContent = "Great job. Worry volume goes down when you come back to NOW.";
          return;
        }
        box.textContent = groundScript[groundStep];
      }, 8000);
      addInterval(id);
    }

    // Box Breathing (dot moves around square)
    let breathRunning = false;
    let breathPhase = 0;
    let breathTicks = 0;

    const breathPhases = [
      { label:"In (4)",   color:"#14B8A6" },
      { label:"Hold (4)", color:"#3B82F6" },
      { label:"Out (4)",  color:"#F59E0B" },
      { label:"Hold (4)", color:"#7C3AED" }
    ];

    function setBreathLabel(){
      const el = document.getElementById("breath-label");
      if(!el) return;
      el.textContent = breathPhases[breathPhase].label;
      el.style.color = breathPhases[breathPhase].color;
    }

    function moveBreathDot(p){
      const dot = document.getElementById("breath-dot");
      if(!dot) return;

      // square corners: (48,48) → (152,48) → (152,152) → (48,152) → back
      // p is 0..1 within current side
      let x=48, y=48;
      if(breathPhase===0){ x = 48 + 104*p; y = 48; }
      if(breathPhase===1){ x = 152; y = 48 + 104*p; }
      if(breathPhase===2){ x = 152 - 104*p; y = 152; }
      if(breathPhase===3){ x = 48; y = 152 - 104*p; }

      dot.setAttribute("cx", String(x));
      dot.setAttribute("cy", String(y));
    }

    function toggleBoxBreath(){
      const btn = document.getElementById("breath-btn");
      if(!btn) return;

      if(breathRunning){
        breathRunning = false;
        btn.textContent = "Start Box Breath";
        const label = document.getElementById("breath-label");
        if(label){ label.textContent = "Ready"; label.style.color = "#0F766E"; }
        clearAllIntervals();
        // reset dot
        moveBreathDot(0);
        breathPhase = 0;
        breathTicks = 0;
        return;
      }

      // start
      breathRunning = true;
      btn.textContent = "Stop";
      breathPhase = 0;
      breathTicks = 0;
      setBreathLabel();
      moveBreathDot(0);

      clearAllIntervals();
      const id = setInterval(()=>{
        if(!breathRunning){ clearInterval(id); return; }

        breathTicks++; // 1 tick per second
        const p = Math.min(1, breathTicks / 4);
        moveBreathDot(p);

        if(breathTicks >= 4){
          breathTicks = 0;
          breathPhase = (breathPhase + 1) % 4;
          setBreathLabel();
          moveBreathDot(0);
        }
      }, 1000);
      addInterval(id);
    }

    // Worry Box Timer 60s
    let wboxRunning = false;
    function startWorryBox(){
      const btn = document.getElementById("wbox-btn");
      const timer = document.getElementById("wbox-timer");
      const blob = document.getElementById("wbox-blob");
      const spark = document.getElementById("wbox-spark");
      if(!btn || !timer) return;

      if(wboxRunning) return;
      wboxRunning = true;

      btn.disabled = true;
      btn.textContent = "Worry Box Running...";
      let t = 60;

      // blob tries to escape at first
      if(blob){
        blob.style.transition = "transform 0.3s ease";
        blob.style.transform = "translateY(6px) scale(1.05)";
      }

      clearAllIntervals();
      const id = setInterval(()=>{
        t--;
        const m = Math.floor(t/60);
        const s = t%60;
        timer.textContent = `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`;

        // mid-way calm
        if(t === 35 && blob){
          blob.style.transform = "translateY(18px) scale(0.85)";
          blob.style.opacity = "0.65";
        }

        if(t <= 0){
          clearInterval(id);
          timer.textContent = "DONE!";
          wboxRunning = false;

          // lock-in visual: blob goes into box, spark appears
          if(blob){
            blob.style.transition = "transform 0.45s ease, opacity 0.45s ease";
            blob.style.transform = "translateY(78px) scale(0.45)";
            blob.style.opacity = "0.0";
          }
          if(spark){
            spark.style.transition = "opacity 0.3s ease";
            spark.style.opacity = "1";
            setTimeout(()=> spark.style.opacity = "0", 1100);
          }

          btn.disabled = false;
          btn.textContent = "Run Worry Box Again (60s)";
          // reset for next run after a moment
          setTimeout(()=>{
            if(timer) timer.textContent = "01:00";
            if(blob){
              blob.style.transition = "none";
              blob.style.transform = "translateY(0) scale(1)";
              blob.style.opacity = "1";
            }
          }, 1400);
        }
      }, 1000);
      addInterval(id);
    }

    // Check the Facts
    function doFacts(){
      const know = document.getElementById("fact-know");
      const guess = document.getElementById("fact-guess");
      const step = document.getElementById("fact-step");
      const out = document.getElementById("facts-out");
      const scene = document.getElementById("scene-facts");

      if(!out) return;

      const k = (know?.value || "").trim() || "—";
      const g = (guess?.value || "").trim() || "—";
      const s = (step?.value || "").trim() || "—";

      out.style.display = "block";
      out.textContent = `FACT: ${k}  |  GUESS: ${g}  |  NEXT STEP: ${s}`;

      // little pop
      try{
        if(scene){
          scene.classList.remove("poppy");
          void scene.offsetWidth;
          scene.classList.add("poppy");
          setTimeout(()=> scene.classList.remove("poppy"), 650);
        }
      }catch(e){}
    }

    // Shake & Reset 10s
    function startShake(){
      const btn = document.getElementById("shake-btn");
      const timer = document.getElementById("shake-timer");
      const card = document.getElementById("shake-card");
      const scene = document.getElementById("scene-shake");
      if(!btn || !timer || !card) return;

      btn.disabled = true;
      btn.textContent = "SHAKE!!!";
      let t = 10;
      timer.textContent = "00:10";

      card.classList.add("card-shaking");
      try{
        if(scene){
          scene.classList.remove("poppy");
          void scene.offsetWidth;
          scene.classList.add("poppy");
        }
      }catch(e){}

      clearAllIntervals();
      const id = setInterval(()=>{
        t--;
        timer.textContent = `00:${String(t).padStart(2,"0")}`;
        if(t<=0){
          clearInterval(id);
          card.classList.remove("card-shaking");
          timer.textContent = "RESET!";
          btn.disabled = false;
          btn.textContent = "Start 10s Shake";
          setTimeout(()=> timer.textContent = "00:10", 900);
        }
      }, 1000);
      addInterval(id);
    }

    // Start app
    showHome();
  </script>
</body>
</html>
